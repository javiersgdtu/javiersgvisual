var textmouseover = ["Following a friend’s referral, <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Kim Ki Woo</span> arrives at the Parks’ House with a fake English diploma. He plans to become the English teacher of <span class='characterText DaHye' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Hye</span>, the daughter of the wealthy Park family.</br> He is received by <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> the loyal housekeeper who guides him in the impressive building. In this first scene, we also meet Mrs. Park, <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span>, and her two children. </br>After a successful English class trial, <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> is hired. At the end of the scene, <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> chats with him about the artistic skills of <span class='characterText DaSong' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Song</span>, her son. On his way out, <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> proposes her to contact an art teacher that could boost all his potential. The lie starts growing.",

    "<span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> brings his sister <span class='characterText KiJung' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Jung</span> to Parks’ house to play as an art teacher called Jessica. After her trial class, she convinces <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> to hire her as art therapy teacher to help <span class='characterText DaSong' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Song</span> to overcome his childhood traumas. Meanwhile, <span class='characterText DaHye' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Hye</span> and <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> starts flirting during the English class.</br> At the end of the scene, <span class='characterText MrPark' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Mr. Park</span>, the busy family business man, is introduced and offers Jessica to bring her home driven by the family chauffer. On her way back, she leaves her underwear into <span class='characterText MrPark' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Mr. Park</span>’s car.",

    "<span class='characterText MrPark' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Mr. Park</span> discovers Jessica’s underwear under the seat of his car and thinks that his chauffer is having sexual encounters there. He discusses about it with <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> in <span class='placesText kitchen' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'> the Kitchen</span> while <span class='characterText KiJung' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Jung</span> spies the conversation from <span class='placesText entrancestairs' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>the first-floor stairs</span>. </br> On her way out of the house, <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> mentions her that the old chauffer has been fired. Then, <span class='characterText KiJung' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Jung</span> seizes the opportunity to refer a new chauffer: her father, <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span>.",

    "Only one of the Kims, <span class='characterText ChungSook' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Chung Sook</span>, is left to be included in the Parks’ house hoax. </br>To do so, they have to find the way of firing <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span>, the loyal housekeeper. During an English class, <span class='characterText DaHye' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Hye</span> confesses to <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> about the forbidden fruit in the house: peaches. <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> has extreme allergy reactions to them.  This revelation triggers a coordinated family plot to make <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> believe that the housekeeper has Tuberculosis. By inoculating peach skin to her, she ends up with allergy attacks that brings her to the hospital. </br>This scene culminates when <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> and <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span> arrive home and discover a 'bleeding' napkin in the trash. <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> is fired and <span class='characterText ChungSook' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Chung Sook</span> replaces her as housekeeper.",

    "Everything seems to go well for the Kims. Their scam has led them to be all employed for the Parks. </br>The Parks decide to go camping and leave the house under the supervision of <span class='characterText ChungSook' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Chung Sook</span>. This is the perfect excuse for the Kims to live for a night as if they were the owners of the house. In a long conversation in <span class='placesText livingroom' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>the living room</span>, they drink, fantasize and reflect on their reality.</br> Suddenly someone pushes the intercom button.",

    "<span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span>, the fired housekeeper, has returned to the house. She wants to pick up something that she has forgotten in the <span class='placesText basement' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>Basement</span>. </br>In this scene, we discover <span class='placesText bunker' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>bunker</span> under the basement where <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> has been hiding her husband <span class='characterText GeunSe' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Geun Se</span> for a long time. In a plot twist, the Kims are exposed and become the hostages of <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> and <span class='characterText GeunSe' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Geun Se</span>. After a fierce fight in <span class='placesText livingroom' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>the living room</span> there is a sudden call: the Parks have cancelled their camping because of the rain. They will arrive at home in 8 minutes and they want <a href='https://food52.com/blog/25002-what-is-ram-don'>Ram-Don</a>.</br> The Kims gain momentum again and lock <span class='characterText GeunSe' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Geun Se</span> and <span class='characterText MoonGwang' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Moon Gwang</span> in the basement. After a quick cleaning, <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span>, <span class='characterText KiJung' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Jung</span> and <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> hide under <span class='placesText livingroom' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>the living room’s</span> table while <span class='characterText YeonKyo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Yeon Kyo</span> and <span class='characterText MrPark' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Mr. Park</span> sleep in the coach guarding <span class='characterText DaSong' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Song</span> who has decided to camp in the <span class='placesText garden' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>garden</span> overnight. In the middle of the night, they manage to scape and return to their flooded house.",

    "The Parks celebrate <span class='characterText DaSong' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Da Song</span> birthday in the <span class='placesText garden' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>garden</span>. <span class='characterText GeunSe' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Geun Se</span> sets the spark when he escapes from <span class='placesText bunker' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'> the bunker</span> and revenges the death of his wife. The party turns into a battle field with several casualties. As a result, <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span> has to escape after stabbing <span class='characterText MrPark' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Mr. Park</span>.",

    "In the epilogue, we see how <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span> has become the new inhabitant of the <span class='placesText bunker' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>bunker</span>. In the final scene, <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span> fantasizes with getting rich to buy the house and reunite the family. In the last scene <span class='characterText KiWoo' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Woo</span>, <span class='characterText ChungSook' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Chung Sook</span> and <span class='characterText KiTaek' onmouseover='textmouseOver(this)' onmouseout='textmouseOut(this)'>Ki Taek</span> hug in the <span class='placesText garden' onmouseover='handleMouseOverTextRoom(this)' onmouseout='handleMouseOutTextRoom(this)'>garden</span>. Fade out and reality hits again."

];

var Characters = [{ "Character": "Ki Woo", "Family": "Kim", "Description": null, "Actor": "Woo-sik Choi", "Role": "English Teacher", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Ki%20Woo.png?raw=true", "Color": " rgb(255, 127, 0)", "id": "Ki_Woo" }, { "Character": "Ki Jung", "Family": "Kim", "Description": null, "Actor": "So-dam Park", "Role": "Art Teacher", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Ki%20Jung.png?raw=true", "Color": "rgb(253,191,111)", "id": "Ki_Jung" }, { "Character": "Ki Taek", "Family": "Kim", "Description": null, "Actor": "Kang-ho Song", "Role": "Chauffeur", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Ki%20Taek.png?raw=true", "Color": "rgb(227,26,28)", "id": "Ki_Taek" }, { "Character": "Chung Sook", "Family": "Kim", "Description": null, "Actor": "Hye-jin Jang", "Role": "Housekeeper", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Chung%20Sook.png?raw=true", "Color": "#ff9999", "id": "Chung_Sook" }, { "Character": "Yeon Kyo", "Family": "Park", "Description": null, "Actor": "Yeo-jeong Jo", "Role": "Mother", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Yeon%20Kyo.png?raw=true", "Color": "rgb(106,61,154)", "id": "Yeon_Kyo" }, { "Character": "Mr. Park", "Family": "Park", "Description": null, "Actor": "Sun-kyun Lee", "Role": "Father", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Mr.Park.png?raw=true", "Color": "rgb(202,178,214)", "id": "Mr._Park" }, { "Character": "Da Hye", "Family": "Park", "Description": null, "Actor": "Ji-so Jung", "Role": "Daughter", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Da%20Hye.png?raw=true", "Color": "rgb(31,120,180)", "id": "Da_Hye" }, { "Character": "Da Song", "Family": "Park", "Description": null, "Actor": "Hyun-jun Jung", "Role": "Son", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Da%20Song.png?raw=true", "Color": "rgb(166,206,227)", "id": "Da_Song" }, { "Character": "Moon Gwang", "Family": null, "Description": null, "Actor": "Jeong-eun Lee", "Role": "First Housekeeper", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Moon%20Gwang.png?raw=true", "Color": "rgb(51,160,44)", "id": "Moon_Gwang" }, { "Character": "Geun Se", "Family": null, "Description": null, "Actor": "Myeong-hoon Park", "Role": "First Housekeeper's husband", "urlImage": "https:\/\/github.com\/javiersgdtu\/javiersgvisual\/blob\/master\/assets\/img\/characters-scale\/Geun%20Se.png?raw=true", "Color": "rgb(178,223,138)", "id": "Geun_Se" }, { "Character": "First chaufer", "Family": null, "Description": null, "Actor": null, "Role": null, "urlImage": "\" \"", "Color": "#917e0d", "id": "Firstchaufer" }, { "Character": "Party attendants", "Family": null, "Description": null, "Actor": null, "Role": null, "urlImage": "\" \"", "Color": "#f2d213", "id": "Partyattendants" }];

function textmouseOver(elem) {

    var match = ("#" + d3.select(elem).style("--match")).replace(/\s/g, '')

    d3.select(elem).transition().duration(700).style("font-size", "27px");

    svg.select(match)
        .transition()
        .duration(1000)
        .ease(d3.easeLinear)
        .attr("fill", function(d, i) {
            return (d.urlImage) ? "url(#" + d.id + ")" : "orange"
        })
        .attr("r", radius * 5)
        .attr("stroke", function(d) { return colorCharacter(d.Character) })
        .attr("stroke-width", 15)
        .attr("stroke-dasharray", 10)

}

function textmouseOut(elem) {
    var match = ("#" + d3.select(elem).style("--match")).replace(/\s/g, '')

    d3.select(elem).transition().duration(500).style("font-size", "19px")

    svg.select(match).transition().duration(1000).attr("fill", function(d) {
        return colorCharacter(d.Character)
    }).attr("r", radius).attr("stroke-width", 0)
}

function handleMouseOverTextRoom(elem) {

    var match = ("#" + d3.select(elem).style("--match")).replace(/\s/g, '');
    d3.select(elem).transition().duration(700).style("font-size", "27px");

    d3.select(match).transition().duration(500)
        .style("stroke-width", "10px").style("opacity", 1)

    d3.select("#area").remove(); //Remove previous text.

    var elemtitle = d3.select(match).select("title")
    var parenttitle = d3.select(match.parentNode).select("title")

    d3.select("#house-svg")
        .append("text")
        .attr("id", "area")
        .text(function(d) {

            return parenttitle.text().match("Stairs|Intercom|Kitchen") == null ? elemtitle.text() : parenttitle.text()
        })
        .attr("x", d3.select("#house-svg").attr("width") / 4 + 50)
        .attr("y", 100)

}


function handleMouseOutTextRoom(elem) {
    var match = ("#" + d3.select(elem).style("--match")).replace(/\s/g, '');
    d3.select(elem).transition().duration(500).style("font-size", "19px")

    var is_check = d3.select(match).attr("checkbox")
    d3.select(match)
        .transition()
        .duration(500)
        .style("stroke-width", "0.5px")
        .style("opacity", function() {
            return (is_check == 1) ? 1 : 0.5
        });
    var parenttitle = d3.select(match.parentNode).select("title")

    d3.select("#area").remove();

}