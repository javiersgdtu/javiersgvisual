var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}},$jscomp.arrayIterator=function(t){return{next:$jscomp.arrayIteratorImpl(t)}},$jscomp.makeIterator=function(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):$jscomp.arrayIterator(t)},$jscomp.arrayFromIterator=function(t){for(var e,a=[];!(e=t.next()).done;)a.push(e.value);return a},$jscomp.arrayFromIterable=function(t){return t instanceof Array?t:$jscomp.arrayFromIterator($jscomp.makeIterator(t))};var svg=d3.select("body").select("svg"),y_leg=700,width_leg=50,x_text=1100,y_text=100,textinfo=d3.select("svg").append("g").attr("class","textinfo").attr("transform","translate("+x_text+","+y_text+")");d3.selectAll("path").attr("text",0);var array_vl=[],array_loc=[],i=0;for(i=0;i<d3.selectAll("path")._groups[0].length;i++)array_loc=[].concat($jscomp.arrayFromIterable(array_loc),[d3.selectAll("path")._groups[0][i].id]);d3.csv("/assets/data/map.csv",(function(t){t.value=+t.value,array_vl=[].concat($jscomp.arrayFromIterable(array_vl),[t.value]),d3.select("#"+t.location).attr("text",t.value)}),(function(t,e){if(t)throw t;var a=[],r="#e6ff99 #c7e9b4 #7fcdbb #41b6c4 #1d91c0 #225ea8 #253494 #081d58".split(" "),n=d3.scaleQuantile().domain([0,8,d3.max(array_vl)]).range(r);d3.selectAll("path").each((function(t){a=[].concat($jscomp.arrayFromIterable(a),[d3.select(this).attr("text")])}));var o=svg.selectAll(".legend").data([0].concat(n.quantiles()),(function(t){return t}));(o=o.enter().append("g").attr("class","legend")).append("rect").attr("transform","translate(30,0)").attr("x",(function(t,e){return width_leg*e})).attr("y",y_leg).attr("width",width_leg).attr("height",width_leg).style("fill",(function(t,e){return r[e]})),o.append("text").attr("transform","translate(30,0)").attr("class","mono").text((function(t){return"â‰¥ "+Math.round(t)})).attr("x",(function(t,e){return width_leg*e})).attr("y",y_leg+width_leg+20),svg.append("text").text("Heat map on patient visits").attr("font-weight","bold").attr("font-size",30).attr("x",y_leg/1.1).attr("y",28),svg.append("text").text("Visits Distribution by location at refugee camp").attr("x",width_leg).attr("y",y_leg-width_leg/2),textinfo.append("foreignObject").attr("width",450).attr("height",100).append("xhtml:span").html("The area represents a refugee camp. The heat map captures the number of patients checked in the clinics per living location.<span style='font-size:14px;color:#A9A9A9'> Made with D3 and Inkscape.</span> "),textinfo.append("text").text("Total number of visits: 2241").attr("x",100).attr("y",140),textinfo.append("text").text("Total number of patients with location recorded: 1798").attr("y",170),textinfo.append("text").text("Total number of patients without location recorded: 425").attr("y",2*y_text),textinfo.append("text").text("Total area = 11.125 km2").attr("x",100).attr("y",520),textinfo.append("text").text("V = Village + N = Neighbourhood").attr("x",100).attr("y",550),textinfo.append("rect").attr("x",100).attr("y",580).attr("stroke","black").attr("width",70).attr("height",30).attr("fill","#ff8990"),textinfo.append("rect").attr("x",100).attr("y",630).attr("stroke","black").attr("width",70).attr("height",30).attr("fill","#feff89"),textinfo.append("text").text("Settlement public spaces").attr("font-size",16).attr("x",175).attr("y",y_leg-y_text),textinfo.append("text").text("Institutional blocks").attr("font-size",16).attr("x",175).attr("y",650),d3.selectAll("path").attr("fill",r[0]).on("mouseover",(function(){var t=d3.select(this)._groups[0][0].id,e=d3.select(this).attr("text");"unumed"!=d3.select(this).attr("id")&&(d3.select(this).attr("stroke","red").attr("stroke-width",2),textinfo.append("text").attr("font-size",25).attr("x",100).attr("y",3.5*y_text).attr("id","id"+t).text((function(){return 1==t.startsWith("-",2)?t+": "+e+" patients":t.replace("_"," ")})))})).on("mouseout",(function(){d3.select(this).attr("stroke","none"),d3.select("#id"+d3.select(this)._groups[0][0].id).remove()})).transition().duration(1500).attr("fill",(function(t,e){return n(a[e])}))}));